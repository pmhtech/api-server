<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="SysCode">

	<insert id="insert" parameterType="sysCode">
	/*	SysCode.insert	*/
	
	INSERT INTO SYS_CODE(
		COMPANY
		,PRE_CD
		,CODE
		,CODE_NM
		,REF1
		,REF2
		,REF3
		,REF4
		,REF5
		,SORT
		,USE_YN
		,MEMO
		,CREATER
		,CREATE_DT
		,CHANGER
		,CHANGE_DT
		,CHANGE_IP
	
	)VALUES(
		,#{COMPANY}
		,#{PRE_CD}
		,#{CODE}
		,#{CODE_NM}
		,#{REF1}
		,#{REF2}
		,#{REF3}
		,#{REF4}
		,#{REF5}
		,#{SORT}
		,#{USE_YN}
		,#{MEMO}
		,#{CREATER}
		,#{CREATE_DT}
		,#{CHANGER}
		,#{CHANGE_DT}
		,#{CHANGE_IP}
	)
	
	
	</insert>
	
	<update id="update" parameterType="sysCode">
	/*	SysCode.update	*/
	UPDATE  SYS_CODE
	SET		CODE_NM		= #{CODE_NM}
			,REF1		= #{REF1}
			,REF2		= #{REF2}
			,REF3		= #{REF3}
			,REF4		= #{REF4}
			,REF5		= #{REF5}
			,SORT		= #{SORT}
			,USE_YN		= #{USE_YN}
			,MEMO		= #{MEMO}
			,CHANGER	= #{CHANGER}
			,CHANGE_DT	= SYSDATE()
			,CHANGE_IP	= #{CHANGE_IP}
	WHERE	COMPANY	= #{COMPANY}
	AND		PRE_CD	= #{PRE_CD}
	AND		CODE	= #{CODE}
	</update>
	
	<delete id="delete" parameterType="paramMap">
	/*	SysCode.delete	*/
	DELETE FROM SYS_CODE A
	WHERE	A.COMPANY	= #{COMPANY}
	AND		PRE_CD	= #{PRE_CD}
	AND		CODE	= #{CODE}
	</delete>

	<select id="selectMaster" parameterType="paramMap" resultType="resultMap">
		/*	SysCode.selectMaster	*/
		SELECT	A.COMPANY
				,A.PRE_CD
				,B.LOCALE_CD
				, IF(A.CODE='0000000000',C.REF2,A.CODE) AS CODE
				, IF(A.CODE='0000000000',C.CODE_NM,B.CODE_NM) AS CODE_NM
				,B.REF1
				,B.REF2
				,B.REF4
				,B.REF5
				,B.SORT
				,B.MEMO
				,B.CREATER
				,B.CREATE_DT
				,B.CHANGER
				,B.CHANGE_DT
				,B.CHANGE_IP
		FROM	SYS_CODE A
				LEFT OUTER JOIN(
					SELECT	A.COMPANY
							,A.PRE_CD
							,A.CODE
							,A.LOCALE_CD
							,A.CODE_NM
							,A.REF1
							,A.REF2
							,A.REF4
							,A.REF5
							,A.SORT
							,A.MEMO
							,A.CREATER
							,A.CREATE_DT
							,A.CHANGER
							,A.CHANGE_DT
							,A.CHANGE_IP
					FROM	SYS_CODE_LOCALE A
					WHERE 	A.LOCALE_CD = 'KOR'
				) B ON(B.COMPANY= A.COMPANY AND B.PRE_CD = A.PRE_CD AND B.CODE = A.CODE)
				LEFT OUTER JOIN SYS_CODE_LOCALE C ON(C.COMPANY=A.COMPANY AND C.PRE_CD = 'COM_000005' AND C.REF1 =A.CODE AND C.LOCALE_CD='KOR')
				ORDER BY B.PRE_CD, B.SORT
	</select>
	<select id="selectList" parameterType="paramMap" resultType="resultMap">
	/*	SysCode.selectList	*/
		SELECT	A.COMPANY
				,A.PRE_CD
				,B.LOCALE_CD
				,A.CODE
				,B.CODE_NM
				,A.REF1
				,A.REF2
				,A.REF4
				,A.REF5
				,B.MEMO
				,B.CREATER
				,B.CREATE_DT
				,B.CHANGER
				,B.CHANGE_DT
				,B.CHANGE_IP
		FROM	SYS_CODE A
				LEFT OUTER JOIN(
					SELECT	A.COMPANY
							,A.PRE_CD
							,A.CODE
							,A.LOCALE_CD
							,A.CODE_NM
							,A.REF1
							,A.REF2
							,A.REF4
							,A.REF5
							,A.MEMO
							,A.CREATER
							,A.CREATE_DT
							,A.CHANGER
							,A.CHANGE_DT
							,A.CHANGE_IP
					FROM	SYS_CODE_LOCALE A
					WHERE 	A.LOCALE_CD = 'KOR'
					<if test="!(PRE_CD == ''	||	PRE_CD == null)">
					AND		A.PRE_CD = #{PRE_CD}
					</if>
					AND		A.CODE!='0000000000'
				) B ON(B.COMPANY= A.COMPANY AND B.PRE_CD = A.PRE_CD AND B.CODE = A.CODE)
		WHERE	1=1
		<if test="!(LOCALE_CD == ''	||	LOCALE_CD == null)">
		AND		B.LOCALE_CD = #{LOCALE_CD}
		</if>
		<if test="!(PRE_CD == ''	||	PRE_CD == null)">
		AND		A.PRE_CD = #{PRE_CD}
		</if>
		AND		A.CODE!='0000000000'
	</select>
	
	<select id="selectGroupList" parameterType="paramMap" resultType="resultMap">
	/*	SysCode.selectGroupList	*/
		SELECT	A.COMPANY
				,A.PRE_CD
				,B.LOCALE_CD
				,A.CODE
				,B.CODE_NM
				,A.REF1
				,A.REF2
				,A.REF4
				,A.REF5
				,B.MEMO
				,B.CREATER
				,B.CREATE_DT
				,B.CHANGER
				,B.CHANGE_DT
				,B.CHANGE_IP
		FROM	SYS_CODE A
				LEFT OUTER JOIN(
					SELECT	A.COMPANY
							,A.PRE_CD
							,A.CODE
							,A.LOCALE_CD
							,A.CODE_NM
							,A.REF1
							,A.REF2
							,A.REF4
							,A.REF5
							,A.MEMO
							,A.CREATER
							,A.CREATE_DT
							,A.CHANGER
							,A.CHANGE_DT
							,A.CHANGE_IP
					FROM	SYS_CODE_LOCALE A
					WHERE 	A.LOCALE_CD = #{LOCALE_CD}
					AND		A.CODE='0000000000'
				) B ON(B.COMPANY= A.COMPANY AND B.PRE_CD = A.PRE_CD AND B.CODE = A.CODE)
		WHERE	A.CODE='0000000000'
	</select>
</mapper> 
